
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>GUI</title><meta name="generator" content="MATLAB 9.9"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-03-08"><meta name="DC.source" content="GUI.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="keyword">function</span> GUI(Transitions,Gases)

data = Transitions;
tempData = Transitions;

fig = uifigure(<span class="string">'Visible'</span>,<span class="string">'off'</span>,<span class="string">'Position'</span>,[15 10 1900 1025]);

lblTitle = uilabel(fig,<span class="string">'Position'</span>,[425,875,500,50]);
lblTitle.Text = <span class="string">"GUI for modelling Molecular Spectra"</span>;
lblTitle.FontSize = 20;

ax = uiaxes(fig,<span class="string">'Position'</span>,[100,100,1050,750]);

lblModelType = uilabel(fig,<span class="string">'Position'</span>,[1300,835,250,50]);
lblModelType.Text = <span class="string">"Approximation"</span>;
ddModelType = uidropdown(fig,<span class="string">'Position'</span>,[1300,800,250,50]);
ddModelType.Items = {<span class="string">'Mcleans'</span>,<span class="string">'Simple Empirical'</span>,<span class="string">'Kielkopf'</span>};

lblGasSelect = uilabel(fig,<span class="string">'Position'</span>,[1300,760,250,50]);
lblGasSelect.Text = <span class="string">"Select Gas"</span>;
ddGasSelect = uidropdown(fig,<span class="string">'Position'</span>,[1300,725,250,50]);

ddGasSelect.Items = keys(Gases);
gasChoice = ddGasSelect.Value;
gasFind = (tempData(:,1)== Gases(gasChoice));
tempData = tempData(gasFind,(1:10));

lblIsotopologueSelect = uilabel(fig,<span class="string">'Position'</span>,[1600,835,250,50]);
lblIsotopologueSelect.Text = <span class="string">"Select Isotopologue"</span>;

lBoxIsotopologueSelect = uilistbox(fig,<span class="keyword">...</span>
    <span class="string">'Position'</span>,[1600,725,250,125],<span class="keyword">...</span>
    <span class="string">'Multiselect'</span>,<span class="string">'on'</span>);
numIso = max(tempData(:,2));
lBoxIsotopologueSelect.Items = sprintfc(<span class="string">'%01d'</span>,1:numIso);

ddGasSelect.ValueChangedFcn = @(dd,event)DropDownGasChanged(ddGasSelect,lBoxIsotopologueSelect,Transitions,Gases);

lblFrequencyStart = uilabel(fig,<span class="string">'Position'</span>,[1300,685,250,50]);
lblFrequencyStart.Text = <span class="string">"Frequency Start (cm-1)"</span>;
editFrequencyStart = uieditfield(fig,<span class="string">'numeric'</span>,<span class="string">'Position'</span>,[1300,650,250,50]);

lblFrequencyEnd = uilabel(fig,<span class="string">'Position'</span>,[1300,610,250,50]);
lblFrequencyEnd.Text = <span class="string">"Frequency End (cm-1)"</span>;
editFrequencyEnd = uieditfield(fig,<span class="string">'numeric'</span>,<span class="string">'Position'</span>,[1300,575,250,50]);

lblFrequencyStartNm = uilabel(fig,<span class="string">'Position'</span>,[1600,685,250,50]);
lblFrequencyStartNm.Text = <span class="string">"Frequency Start (nm)"</span>;
editFrequencyStartNm = uieditfield(fig,<span class="string">'numeric'</span>,<span class="string">'Position'</span>,[1600,650,250,50]);

lblFrequencyEndNm = uilabel(fig,<span class="string">'Position'</span>,[1600,610,250,50]);
lblFrequencyEndNm.Text = <span class="string">"Frequency End (nm)"</span>;
editFrequencyEndNm = uieditfield(fig,<span class="string">'numeric'</span>,<span class="string">'Position'</span>,[1600,575,250,50]);


editFrequencyStart.ValueChangedFcn = @(numfld,event)changeUnits(editFrequencyStartNm,editFrequencyStart);
editFrequencyEnd.ValueChangedFcn = @(numfld,event)changeUnits(editFrequencyEndNm,editFrequencyEnd);
editFrequencyStartNm.ValueChangedFcn = @(numfld,event)changeUnits(editFrequencyStart,editFrequencyStartNm);
editFrequencyEndNm.ValueChangedFcn = @(numfld,event)changeUnits(editFrequencyEnd,editFrequencyEndNm);

lblTemp = uilabel(fig,<span class="string">'Position'</span>,[1300,535,250,50]);
lblTemp.Text = <span class="string">"Temperature (K)"</span>;
editTemp = uieditfield(fig,<span class="string">'numeric'</span>,<span class="string">'Position'</span>,[1300,500,250,50]);

lblTempDeg = uilabel(fig,<span class="string">'Position'</span>,[1600,535,250,50]);
text = sprintf(<span class="string">'Temperature (%cC)'</span> , char(176));
lblTempDeg.Text = text;
editTempDeg = uieditfield(fig,<span class="string">'numeric'</span>,<span class="string">'Position'</span>,[1600,500,250,50]);

editTemp.ValueChangedFcn = @(numfld,event)changeTempDeg(editTempDeg,editTemp);
editTempDeg.ValueChangedFcn = @(numfld,event)changeTempK(editTemp,editTempDeg);

lblPressure = uilabel(fig,<span class="string">'Position'</span>,[1300,460,250,50]);
lblPressure.Text = <span class="string">"Pressure (Atm)"</span>;
editPressure = uieditfield(fig,<span class="string">'numeric'</span>,<span class="string">'Position'</span>,[1300,425,250,50],<span class="keyword">...</span>
    <span class="string">'Limits'</span>,[0,Inf],<span class="keyword">...</span>
    <span class="string">'LowerLimitInclusive'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
    <span class="string">'UpperLimitInclusive'</span>,<span class="string">'on'</span>);

lblConcentration = uilabel(fig,<span class="string">'Position'</span>,[1600,460,250,50]);
lblConcentration.Text = <span class="string">"Concentration"</span>;
editConcentration = uieditfield(fig,<span class="string">'numeric'</span>,<span class="string">'Position'</span>,[1600,425,250,50],<span class="keyword">...</span>
    <span class="string">'Limits'</span>,[0,Inf],<span class="keyword">...</span>
    <span class="string">'LowerLimitInclusive'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
    <span class="string">'UpperLimitInclusive'</span>,<span class="string">'on'</span>);

lblPLength = uilabel(fig,<span class="string">'Position'</span>,[1600,385,250,50]);
lblPLength.Text = <span class="string">"Path Length (cm)"</span>;
editPLength = uieditfield(fig,<span class="string">'numeric'</span>,<span class="string">'Position'</span>,[1600,350,250,50],<span class="keyword">...</span>
    <span class="string">'Limits'</span>,[0,Inf],<span class="keyword">...</span>
    <span class="string">'LowerLimitInclusive'</span>,<span class="string">'on'</span>,<span class="keyword">...</span>
    <span class="string">'UpperLimitInclusive'</span>,<span class="string">'on'</span>);

lblPlotType = uilabel(fig,<span class="string">'Position'</span>,[1300,385,250,50]);
lblPlotType.Text = <span class="string">"Plot Type"</span>;
plotTypeSelect = uidropdown(fig,<span class="string">'Position'</span>,[1300,350,250,50]);
plotTypeSelect.Items = {<span class="string">'Absorption'</span>, <span class="string">'Transmission'</span>};

plotButton = uibutton(fig,<span class="keyword">...</span>
<span class="string">'Position'</span>,[1340,275,150,30],<span class="keyword">...</span>
<span class="string">'Text'</span>,<span class="string">'Plot'</span>);

clearButton = uibutton(fig,<span class="keyword">...</span>
<span class="string">'Position'</span>,[1520,275,150,30],<span class="keyword">...</span>
<span class="string">'Text'</span>,<span class="string">'Clear Plot'</span>);
clearButton.Enable = <span class="string">'off'</span>;

addPlotsButton = uibutton(fig,<span class="keyword">...</span>
    <span class="string">'Position'</span>,[1700,275,150,30],<span class="keyword">...</span>
    <span class="string">'Text'</span>,<span class="string">'Sum Current Plots'</span>);
addPlotsButton.Enable = <span class="string">'off'</span>;


numClicks = 0;
guidata(fig,numClicks);

addPlotsButton.ButtonPushedFcn = @(btn,event)sumCurrentPlots(fig,ax);
clearButton.ButtonPushedFcn = @(btn,event)clearPlot(fig,ax,clearButton,addPlotsButton,plotButton);

plotButton.ButtonPushedFcn = @(btn,event)plotButtonPress(fig,ax,plotButton,addPlotsButton,<span class="keyword">...</span>
    clearButton,data,Gases,ddModelType,ddGasSelect,plotTypeSelect,lBoxIsotopologueSelect,editFrequencyStart,<span class="keyword">...</span>
    editFrequencyEnd,editTemp,editPressure,editConcentration,editPLength);

fig.Visible = <span class="string">'on'</span>;
<span class="keyword">end</span>

<span class="keyword">function</span> DropDownGasChanged(ddGasSelect,ddIsotopologueSelect,data,Gases)
    val = ddGasSelect.Value;
    gasFind = (data(:,1)== Gases(val));
    data = data(gasFind,(1:10));
    numIso = max(data(:,2));
    ddIsotopologueSelect.Items = sprintfc(<span class="string">'%01d'</span>,1:numIso);
    setappdata(ddGasSelect,<span class="string">'gasChoice'</span>,val);
<span class="keyword">end</span>

<span class="keyword">function</span> changeUnits(editFrequencyStart, editFrequencyStartNm)
editFrequencyStart.Value = 1e7/editFrequencyStartNm.Value;
<span class="keyword">end</span>

<span class="keyword">function</span> changeTempDeg(editTempDeg,editTemp)
    editTempDeg.Value = editTemp.Value - 273.15;
<span class="keyword">end</span>

<span class="keyword">function</span> changeTempK(editTemp,editTempDeg)
    editTemp.Value = round(editTempDeg.Value + 273.15);
<span class="keyword">end</span>

<span class="keyword">function</span> clearPlot(fig,ax,clearButton,addPlotsButton,plotButton)
    numClicks = guidata(fig);
    numClicks = 0;
    guidata(fig,numClicks);
    cla(ax,<span class="string">'reset'</span>);
    clearButton.Enable = <span class="string">'off'</span>;
    addPlotsButton.Enable = <span class="string">'off'</span>;
    plotButton.Enable = <span class="string">'on'</span>;
<span class="keyword">end</span>

<span class="keyword">function</span> sumCurrentPlots(fig,ax)
 numClicks = guidata(fig);
x = getappdata(fig,<span class="string">'xaxis'</span>);
    plotData1 = getappdata(fig,<span class="string">'currentPlot1'</span>);
    plotData2 = getappdata(fig,<span class="string">'currentPlot2'</span>);
    plotData3 = getappdata(fig,<span class="string">'currentPlot3'</span>);
    <span class="keyword">if</span>(numClicks ==2)
        newY = plotData1 + plotData2;
    <span class="keyword">else</span>
        newY = plotData1 + plotData2 + plotData3;
    <span class="keyword">end</span>
    plot(ax,x,newY,<span class="string">'DisplayName'</span>,<span class="string">'Summation'</span>);
<span class="keyword">end</span>

<span class="keyword">function</span> plotButtonPress(fig,ax,plotButton,addPlotsButton,clearButton,tempdata,<span class="keyword">...</span>
    Gases,ddModelType,ddGasSelect,plotTypeSelect,lBoxIsotopologueSelect,editFrequencyStart,<span class="keyword">...</span>
    editFrequencyEnd,editTemp,editPressure,editConcentration,editPLength)

clearButton.Enable = <span class="string">'on'</span>;
    numClicks = guidata(fig);
    numClicks = numClicks + 1;
    <span class="keyword">if</span>(numClicks == 2)
        addPlotsButton.Enable = <span class="string">'on'</span>;
    <span class="keyword">end</span>
    <span class="keyword">if</span>(numClicks == 3)
        plotButton.Enable = <span class="string">'off'</span>;
    <span class="keyword">end</span>
    guidata(fig,numClicks);
    <span class="comment">% handles.plotButton.UserData = handles.plotButton.UserData +1;</span>

    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    <span class="comment">% Resizing data to match selected gas</span>
    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    gasChoice = ddGasSelect.Value;
    gasFind = (tempdata(:,1)== Gases(gasChoice));
    tempdata = tempdata(gasFind,(1:10));

    isoChoice = sort(str2double(lBoxIsotopologueSelect.Value));            <span class="comment">% Isotopologue(s) to be looked at</span>
    isoSize = length(isoChoice);                                           <span class="comment">% Size of isoChoice martix</span>
    data = cell(1,isoSize);
    <span class="keyword">for</span> n = 1: isoSize
        isoFind = (tempdata(:,2 )== isoChoice(n));
        data{n} = tempdata(isoFind,(1:10));
    <span class="keyword">end</span>
    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    <span class="comment">% Reading in Partion data</span>
    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    partitions = cell(1,isoSize);
    <span class="keyword">for</span> n = 1: length(isoChoice)
    partFilePath = strcat(pwd,<span class="string">'\GasData\'</span>,gasChoice,num2str(isoChoice(n)),<span class="string">'.txt'</span>);
    fid = fopen(partFilePath);
    formatSpec  = <span class="string">'%4f %16f %*[^\n]'</span>;
    st0 = textscan(fid,formatSpec);
    fclose(fid);
    partitions{n} = cell2mat(st0);
    <span class="keyword">end</span>
    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    <span class="comment">% Reading in Gas Mass data</span>
    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    filePath = strcat(pwd,<span class="string">'\GasData\molparam.txt'</span>);
    fid = fopen(filePath);
    g0 = textscan(fid,formatSpec);
    fclose(fid);
    masses = cell2mat(g0);

    massFind= (masses == Gases(gasChoice));
    masses = masses(massFind,(1:2));
    masses(:,1) = [];

    vStart = editFrequencyStart.Value;
    vEnd = editFrequencyEnd.Value;
    <span class="keyword">if</span>(vStart&gt;vEnd)
        temp = vEnd;
        vEnd = vStart;
        vStart = temp;
    <span class="keyword">end</span>

    dataSize = zeros (1,isoSize);
    <span class="keyword">for</span> n = 1: isoSize
    vFind = (data{n}(:,3) &gt;= vStart &amp; data{n}(:,3) &lt;= vEnd);
    data{n} = data{n}(vFind,(1:10));
    dataSize(n) = size(data{n},1);
    <span class="keyword">end</span>
    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    <span class="comment">% Declaring Constants</span>
    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    c = 299792458e2;                                <span class="comment">% Speed of light (cm-1)</span>
    h = 6.626e-34;                                  <span class="comment">% Planck constant</span>
    k = 1.38064852e-23;                             <span class="comment">% Boltzmann constant</span>
    c2 = (h*c)/k;                                   <span class="comment">% Second radiation constant</span>
    T = editTemp.Value;                             <span class="comment">% Temperature of system (Kelvin)</span>
    T0 = 296;                                       <span class="comment">% Temperature of system (Kelvin)</span>
    P = editPressure.Value;                         <span class="comment">% Pressure of system (Atmosphere)</span>
    concentration = editConcentration.Value;        <span class="comment">% Concentration</span>
    pLength = editPLength.Value;                    <span class="comment">% Length of cell(cm)</span>
    M = masses(isoChoice);                          <span class="comment">% Molecular mass of the selected gas</span>
    step = 500;                                    <span class="comment">% Number of data points in wavelength</span>
    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    <span class="comment">% Allocating size of cell arrays and matrices</span>
    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    [v,v0,S_t0,gammaAir,gammaSelf,pShift,E_lower,gammaG,gammaL,Y,y] = deal(cell(1,isoSize));
    [Q_tref,Q_t] = deal(zeros(1,isoSize));
    [Q_tref_temp,Q_t_temp] = deal(zeros(1,2,isoSize));
    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    <span class="comment">% HITRAN Data</span>
    <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
    <span class="keyword">for</span> n = 1: isoSize
    v{n} = repmat(linspace(vStart,vEnd,step),dataSize(n),1);
    v0{n} = data{n}(:,3);                                           <span class="comment">% Transition wavenumber</span>
    S_t0{n} = data{n}(:,4);                                         <span class="comment">% Line Intensity</span>
    S_t0{n} = (7.339e21.*S_t0{n})./T;                               <span class="comment">% Line Intensity Conversion</span>
    gammaAir{n} = data{n}(:,6).*(T0/T).^data{n}(:,8);               <span class="comment">% Air broadened HWHM</span>
    gammaSelf{n} = data{n}(:,7).*(T0/T).^data{n}(:,8);              <span class="comment">% Self broadened HWHM</span>
    <span class="comment">% n = data(:,8);                                                % Temperature dependent coefficient for air broadened HWHM(Lorentzian)</span>
    pShift{n} = data{n}(:,9);                                       <span class="comment">% Pressure Shift induced by air</span>
    E_lower{n} = data{n}(:,10);                                     <span class="comment">% Lower State Energy</span>
    Q_tref_temp(:,:,n) = partitions{n}(T0,:);
    Q_tref(n) = Q_tref_temp(n*2);                                   <span class="comment">%</span>
    Q_t_temp(:,:,n) = partitions{n}(T,:);
    Q_t(n) = Q_t_temp(n*2);                                         <span class="comment">%</span>
    gammaG{n} = (v0{n}.*7.1623e-7.*(T/M(n)).^0.5)';                 <span class="comment">% Calculates the Gaussian FWHM</span>
    gammaL{n} = ((2*P).*((concentration.*gammaSelf{n})+ <span class="keyword">...</span><span class="comment">         % Calculates the Lorentzian FWHM</span>
    ((1-concentration).*gammaAir{n})))';
    Y{n} = (gammaL{n}.*sqrt(log(2)))./gammaG{n};                    <span class="comment">% Calculating Y for Voigt lineshape</span>
    <span class="keyword">end</span>

    approxSelect = ddModelType.Value;
    <span class="keyword">if</span>(strcmp(approxSelect,<span class="string">'Mcleans'</span>))
        voigtFinal = Mcleans(isoSize,dataSize,gammaG,v,v0,P,pShift,Y,S_t0,Q_tref,Q_t,c2,E_lower,T,T0,concentration,pLength);
    <span class="keyword">elseif</span>(strcmp(approxSelect,<span class="string">'Simple Empirical'</span>))
        voigtFinal = Simple_Empirical(isoSize,dataSize,gammaL,gammaG,v,v0,S_t0,Q_tref,Q_t,c2,E_lower,T,T0,concentration,pLength,P);
    <span class="keyword">elseif</span>(strcmp(approxSelect,<span class="string">'Kielkopf'</span>))
        voigtFinal = Kielkopf(isoSize,dataSize,gammaL,gammaG,v,v0,S_t0,Q_tref,Q_t,c2,E_lower,T,T0,concentration,pLength,P,pShift);
    <span class="keyword">end</span>

    ax.XGrid=<span class="string">'on'</span>; ax.YGrid=<span class="string">'on'</span>;
    ax.Title.String = <span class="string">"All voigt line shapes for "</span> + gasChoice + <span class="string">" in the range "</span> + vStart + <span class="string">" to "</span> + vEnd;
    ax.YLabel.String = <span class="string">'Absorbance, (I/Io)'</span>;
    ax.XLabel.String = <span class="string">'Frequency, cm-1'</span>;
    ax.NextPlot = <span class="string">'add'</span>;

    isoList = zeros(1,isoSize);
    <span class="keyword">for</span> n = 1: isoSize
         <span class="keyword">if</span>(isempty(voigtFinal{n}))
             isoList(n) = n;
         <span class="keyword">end</span>
    <span class="keyword">end</span>
    isoList = isoList(isoList(1,:)~=0) ;
    absorbanceEmptyLbl = uilabel(fig,<span class="keyword">...</span>
        <span class="string">'Position'</span>, [75,75,500,30],<span class="keyword">...</span>
        <span class="string">'FontSize'</span>, 16);
    formatSpec = [<span class="string">'No absorbance for isotopolgue(s): '</span> repmat(<span class="string">'%1.0f ,'</span>,1,numel(isoList)) <span class="string">' in %s'</span>];
    text = sprintf(formatSpec,isoList,gasChoice);
    absorbanceEmptyLbl.Text = text;
    x = v{1}(1,:);
    approx = voigtFinal(~cellfun(<span class="string">'isempty'</span>,voigtFinal));
    finalApprox = cell(1,length(approx));
    <span class="keyword">for</span> n = 1: length(approx)
        finalApprox{n} = sum(approx{n});
        y{n} = finalApprox{n};
    <span class="keyword">end</span>
    setappdata(fig,<span class="string">'xaxis'</span>,x);
    plotType = plotTypeSelect.Value;
   <span class="keyword">if</span>(strcmp(plotType,<span class="string">'Transmission'</span>))
       y{n} = exp(-1.*y{n});
       ax.YLabel.String = <span class="string">'Transmission'</span>;
   <span class="keyword">end</span>

    <span class="keyword">switch</span> numClicks
        <span class="keyword">case</span> 1
        <span class="keyword">if</span>(length(finalApprox) &gt;1)
             out = sum(cell2mat(y'));
             setappdata(fig,<span class="string">'currentPlot1'</span>,out);
             plot(ax,x,out,<span class="string">'DisplayName'</span>,gasChoice);
        <span class="keyword">else</span>
             setappdata(fig,<span class="string">'currentPlot1'</span>,y{1});
             plot(ax,x,y{1},<span class="string">'DisplayName'</span>,gasChoice);
        <span class="keyword">end</span>

        <span class="keyword">case</span> 2
        <span class="keyword">if</span>(length(finalApprox) &gt;1)
             out = sum(cell2mat(y'));
             setappdata(fig,<span class="string">'currentPlot2'</span>,out);
             plot(ax,x,out,<span class="string">'DisplayName'</span>,gasChoice);
        <span class="keyword">else</span>
             setappdata(fig,<span class="string">'currentPlot2'</span>,y{1});
             plot(ax,x,y{1},<span class="string">'DisplayName'</span>,gasChoice);
        <span class="keyword">end</span>

        <span class="keyword">case</span> 3
        <span class="keyword">if</span>(length(finalApprox) &gt;1)
             out = sum(cell2mat(y'));
             setappdata(fig,<span class="string">'currentPlot3'</span>,out);
             plot(ax,x,out,<span class="string">'DisplayName'</span>,gasChoice);
        <span class="keyword">else</span>
             setappdata(fig,<span class="string">'currentPlot3'</span>,y{1});
             plot(ax,x,y{1},<span class="string">'DisplayName'</span>,gasChoice);
        <span class="keyword">end</span>

    <span class="keyword">end</span>
     legend(ax);
<span class="keyword">end</span>
</pre><pre class="codeoutput error">Not enough input arguments.

Error in GUI (line 4)
data = Transitions;
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020b</a><br></p></div><!--
##### SOURCE BEGIN #####

function GUI(Transitions,Gases)

data = Transitions;
tempData = Transitions;

fig = uifigure('Visible','off','Position',[15 10 1900 1025]);

lblTitle = uilabel(fig,'Position',[425,875,500,50]);
lblTitle.Text = "GUI for modelling Molecular Spectra";
lblTitle.FontSize = 20;

ax = uiaxes(fig,'Position',[100,100,1050,750]);

lblModelType = uilabel(fig,'Position',[1300,835,250,50]);
lblModelType.Text = "Approximation";
ddModelType = uidropdown(fig,'Position',[1300,800,250,50]);    
ddModelType.Items = {'Mcleans','Simple Empirical','Kielkopf'};

lblGasSelect = uilabel(fig,'Position',[1300,760,250,50]);
lblGasSelect.Text = "Select Gas";
ddGasSelect = uidropdown(fig,'Position',[1300,725,250,50]);

ddGasSelect.Items = keys(Gases);
gasChoice = ddGasSelect.Value;
gasFind = (tempData(:,1)== Gases(gasChoice));
tempData = tempData(gasFind,(1:10));

lblIsotopologueSelect = uilabel(fig,'Position',[1600,835,250,50]);
lblIsotopologueSelect.Text = "Select Isotopologue";

lBoxIsotopologueSelect = uilistbox(fig,...
    'Position',[1600,725,250,125],...
    'Multiselect','on');
numIso = max(tempData(:,2));            
lBoxIsotopologueSelect.Items = sprintfc('%01d',1:numIso);

ddGasSelect.ValueChangedFcn = @(dd,event)DropDownGasChanged(ddGasSelect,lBoxIsotopologueSelect,Transitions,Gases);

lblFrequencyStart = uilabel(fig,'Position',[1300,685,250,50]);
lblFrequencyStart.Text = "Frequency Start (cm-1)";
editFrequencyStart = uieditfield(fig,'numeric','Position',[1300,650,250,50]);

lblFrequencyEnd = uilabel(fig,'Position',[1300,610,250,50]);
lblFrequencyEnd.Text = "Frequency End (cm-1)";
editFrequencyEnd = uieditfield(fig,'numeric','Position',[1300,575,250,50]);

lblFrequencyStartNm = uilabel(fig,'Position',[1600,685,250,50]);
lblFrequencyStartNm.Text = "Frequency Start (nm)";
editFrequencyStartNm = uieditfield(fig,'numeric','Position',[1600,650,250,50]);

lblFrequencyEndNm = uilabel(fig,'Position',[1600,610,250,50]);
lblFrequencyEndNm.Text = "Frequency End (nm)";
editFrequencyEndNm = uieditfield(fig,'numeric','Position',[1600,575,250,50]);


editFrequencyStart.ValueChangedFcn = @(numfld,event)changeUnits(editFrequencyStartNm,editFrequencyStart);
editFrequencyEnd.ValueChangedFcn = @(numfld,event)changeUnits(editFrequencyEndNm,editFrequencyEnd);
editFrequencyStartNm.ValueChangedFcn = @(numfld,event)changeUnits(editFrequencyStart,editFrequencyStartNm);
editFrequencyEndNm.ValueChangedFcn = @(numfld,event)changeUnits(editFrequencyEnd,editFrequencyEndNm);

lblTemp = uilabel(fig,'Position',[1300,535,250,50]);
lblTemp.Text = "Temperature (K)";
editTemp = uieditfield(fig,'numeric','Position',[1300,500,250,50]);

lblTempDeg = uilabel(fig,'Position',[1600,535,250,50]);
text = sprintf('Temperature (%cC)' , char(176));
lblTempDeg.Text = text;
editTempDeg = uieditfield(fig,'numeric','Position',[1600,500,250,50]);

editTemp.ValueChangedFcn = @(numfld,event)changeTempDeg(editTempDeg,editTemp);
editTempDeg.ValueChangedFcn = @(numfld,event)changeTempK(editTemp,editTempDeg);

lblPressure = uilabel(fig,'Position',[1300,460,250,50]);
lblPressure.Text = "Pressure (Atm)";
editPressure = uieditfield(fig,'numeric','Position',[1300,425,250,50],...
    'Limits',[0,Inf],...
    'LowerLimitInclusive','on',...
    'UpperLimitInclusive','on');

lblConcentration = uilabel(fig,'Position',[1600,460,250,50]);
lblConcentration.Text = "Concentration";
editConcentration = uieditfield(fig,'numeric','Position',[1600,425,250,50],...
    'Limits',[0,Inf],...
    'LowerLimitInclusive','on',...
    'UpperLimitInclusive','on');

lblPLength = uilabel(fig,'Position',[1600,385,250,50]);
lblPLength.Text = "Path Length (cm)";
editPLength = uieditfield(fig,'numeric','Position',[1600,350,250,50],...
    'Limits',[0,Inf],...
    'LowerLimitInclusive','on',...
    'UpperLimitInclusive','on');

lblPlotType = uilabel(fig,'Position',[1300,385,250,50]);
lblPlotType.Text = "Plot Type";
plotTypeSelect = uidropdown(fig,'Position',[1300,350,250,50]);
plotTypeSelect.Items = {'Absorption', 'Transmission'}; 

plotButton = uibutton(fig,...
'Position',[1340,275,150,30],...
'Text','Plot');

clearButton = uibutton(fig,...
'Position',[1520,275,150,30],...
'Text','Clear Plot');
clearButton.Enable = 'off';

addPlotsButton = uibutton(fig,...
    'Position',[1700,275,150,30],...
    'Text','Sum Current Plots');
addPlotsButton.Enable = 'off';


numClicks = 0;
guidata(fig,numClicks);

addPlotsButton.ButtonPushedFcn = @(btn,event)sumCurrentPlots(fig,ax);
clearButton.ButtonPushedFcn = @(btn,event)clearPlot(fig,ax,clearButton,addPlotsButton,plotButton);

plotButton.ButtonPushedFcn = @(btn,event)plotButtonPress(fig,ax,plotButton,addPlotsButton,...
    clearButton,data,Gases,ddModelType,ddGasSelect,plotTypeSelect,lBoxIsotopologueSelect,editFrequencyStart,...
    editFrequencyEnd,editTemp,editPressure,editConcentration,editPLength); 

fig.Visible = 'on';
end

function DropDownGasChanged(ddGasSelect,ddIsotopologueSelect,data,Gases)
    val = ddGasSelect.Value;
    gasFind = (data(:,1)== Gases(val));
    data = data(gasFind,(1:10));
    numIso = max(data(:,2));            
    ddIsotopologueSelect.Items = sprintfc('%01d',1:numIso);
    setappdata(ddGasSelect,'gasChoice',val);
end

function changeUnits(editFrequencyStart, editFrequencyStartNm)
editFrequencyStart.Value = 1e7/editFrequencyStartNm.Value;
end

function changeTempDeg(editTempDeg,editTemp)
    editTempDeg.Value = editTemp.Value - 273.15;
end

function changeTempK(editTemp,editTempDeg)
    editTemp.Value = round(editTempDeg.Value + 273.15);
end

function clearPlot(fig,ax,clearButton,addPlotsButton,plotButton)
    numClicks = guidata(fig);
    numClicks = 0;
    guidata(fig,numClicks); 
    cla(ax,'reset');
    clearButton.Enable = 'off';
    addPlotsButton.Enable = 'off';
    plotButton.Enable = 'on';   
end

function sumCurrentPlots(fig,ax)
 numClicks = guidata(fig);    
x = getappdata(fig,'xaxis');
    plotData1 = getappdata(fig,'currentPlot1');
    plotData2 = getappdata(fig,'currentPlot2');
    plotData3 = getappdata(fig,'currentPlot3');
    if(numClicks ==2)
        newY = plotData1 + plotData2;
    else
        newY = plotData1 + plotData2 + plotData3;
    end
    plot(ax,x,newY,'DisplayName','Summation');
end

function plotButtonPress(fig,ax,plotButton,addPlotsButton,clearButton,tempdata,...
    Gases,ddModelType,ddGasSelect,plotTypeSelect,lBoxIsotopologueSelect,editFrequencyStart,...
    editFrequencyEnd,editTemp,editPressure,editConcentration,editPLength)
    
clearButton.Enable = 'on';
    numClicks = guidata(fig);
    numClicks = numClicks + 1;
    if(numClicks == 2)
        addPlotsButton.Enable = 'on';
    end
    if(numClicks == 3)
        plotButton.Enable = 'off';
    end
    guidata(fig,numClicks);
    % handles.plotButton.UserData = handles.plotButton.UserData +1;

    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Resizing data to match selected gas
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    gasChoice = ddGasSelect.Value;
    gasFind = (tempdata(:,1)== Gases(gasChoice));
    tempdata = tempdata(gasFind,(1:10));

    isoChoice = sort(str2double(lBoxIsotopologueSelect.Value));            % Isotopologue(s) to be looked at
    isoSize = length(isoChoice);                                           % Size of isoChoice martix
    data = cell(1,isoSize);                 
    for n = 1: isoSize
        isoFind = (tempdata(:,2 )== isoChoice(n));
        data{n} = tempdata(isoFind,(1:10));
    end
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Reading in Partion data
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    partitions = cell(1,isoSize);
    for n = 1: length(isoChoice)
    partFilePath = strcat(pwd,'\GasData\',gasChoice,num2str(isoChoice(n)),'.txt');
    fid = fopen(partFilePath);
    formatSpec  = '%4f %16f %*[^\n]';
    st0 = textscan(fid,formatSpec);
    fclose(fid);
    partitions{n} = cell2mat(st0);
    end
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Reading in Gas Mass data
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    filePath = strcat(pwd,'\GasData\molparam.txt');
    fid = fopen(filePath);
    g0 = textscan(fid,formatSpec);
    fclose(fid);
    masses = cell2mat(g0);

    massFind= (masses == Gases(gasChoice));
    masses = masses(massFind,(1:2));
    masses(:,1) = [];

    vStart = editFrequencyStart.Value;
    vEnd = editFrequencyEnd.Value;
    if(vStart>vEnd)
        temp = vEnd;
        vEnd = vStart;
        vStart = temp;
    end

    dataSize = zeros (1,isoSize);
    for n = 1: isoSize
    vFind = (data{n}(:,3) >= vStart & data{n}(:,3) <= vEnd);
    data{n} = data{n}(vFind,(1:10));
    dataSize(n) = size(data{n},1);
    end
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Declaring Constants 
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    c = 299792458e2;                                % Speed of light (cm-1)
    h = 6.626e-34;                                  % Planck constant
    k = 1.38064852e-23;                             % Boltzmann constant
    c2 = (h*c)/k;                                   % Second radiation constant
    T = editTemp.Value;                             % Temperature of system (Kelvin)
    T0 = 296;                                       % Temperature of system (Kelvin)
    P = editPressure.Value;                         % Pressure of system (Atmosphere)
    concentration = editConcentration.Value;        % Concentration
    pLength = editPLength.Value;                    % Length of cell(cm)
    M = masses(isoChoice);                          % Molecular mass of the selected gas
    step = 500;                                    % Number of data points in wavelength 
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % Allocating size of cell arrays and matrices
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    [v,v0,S_t0,gammaAir,gammaSelf,pShift,E_lower,gammaG,gammaL,Y,y] = deal(cell(1,isoSize));
    [Q_tref,Q_t] = deal(zeros(1,isoSize));
    [Q_tref_temp,Q_t_temp] = deal(zeros(1,2,isoSize));
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    % HITRAN Data  
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    for n = 1: isoSize
    v{n} = repmat(linspace(vStart,vEnd,step),dataSize(n),1);
    v0{n} = data{n}(:,3);                                           % Transition wavenumber
    S_t0{n} = data{n}(:,4);                                         % Line Intensity
    S_t0{n} = (7.339e21.*S_t0{n})./T;                               % Line Intensity Conversion
    gammaAir{n} = data{n}(:,6).*(T0/T).^data{n}(:,8);               % Air broadened HWHM 
    gammaSelf{n} = data{n}(:,7).*(T0/T).^data{n}(:,8);              % Self broadened HWHM
    % n = data(:,8);                                                % Temperature dependent coefficient for air broadened HWHM(Lorentzian)
    pShift{n} = data{n}(:,9);                                       % Pressure Shift induced by air
    E_lower{n} = data{n}(:,10);                                     % Lower State Energy
    Q_tref_temp(:,:,n) = partitions{n}(T0,:);
    Q_tref(n) = Q_tref_temp(n*2);                                   % 
    Q_t_temp(:,:,n) = partitions{n}(T,:);
    Q_t(n) = Q_t_temp(n*2);                                         % 
    gammaG{n} = (v0{n}.*7.1623e-7.*(T/M(n)).^0.5)';                 % Calculates the Gaussian FWHM
    gammaL{n} = ((2*P).*((concentration.*gammaSelf{n})+ ...         % Calculates the Lorentzian FWHM
    ((1-concentration).*gammaAir{n})))';     
    Y{n} = (gammaL{n}.*sqrt(log(2)))./gammaG{n};                    % Calculating Y for Voigt lineshape  
    end

    approxSelect = ddModelType.Value;
    if(strcmp(approxSelect,'Mcleans'))
        voigtFinal = Mcleans(isoSize,dataSize,gammaG,v,v0,P,pShift,Y,S_t0,Q_tref,Q_t,c2,E_lower,T,T0,concentration,pLength);
    elseif(strcmp(approxSelect,'Simple Empirical'))
        voigtFinal = Simple_Empirical(isoSize,dataSize,gammaL,gammaG,v,v0,S_t0,Q_tref,Q_t,c2,E_lower,T,T0,concentration,pLength,P);
    elseif(strcmp(approxSelect,'Kielkopf'))
        voigtFinal = Kielkopf(isoSize,dataSize,gammaL,gammaG,v,v0,S_t0,Q_tref,Q_t,c2,E_lower,T,T0,concentration,pLength,P,pShift);
    end

    ax.XGrid='on'; ax.YGrid='on';
    ax.Title.String = "All voigt line shapes for " + gasChoice + " in the range " + vStart + " to " + vEnd;
    ax.YLabel.String = 'Absorbance, (I/Io)';
    ax.XLabel.String = 'Frequency, cm-1';
    ax.NextPlot = 'add';
    
    isoList = zeros(1,isoSize);
    for n = 1: isoSize
         if(isempty(voigtFinal{n}))
             isoList(n) = n;  
         end
    end
    isoList = isoList(isoList(1,:)~=0) ;
    absorbanceEmptyLbl = uilabel(fig,...
        'Position', [75,75,500,30],...
        'FontSize', 16);
    formatSpec = ['No absorbance for isotopolgue(s): ' repmat('%1.0f ,',1,numel(isoList)) ' in %s'];
    text = sprintf(formatSpec,isoList,gasChoice);
    absorbanceEmptyLbl.Text = text;
    x = v{1}(1,:);
    approx = voigtFinal(~cellfun('isempty',voigtFinal));
    finalApprox = cell(1,length(approx));
    for n = 1: length(approx)
        finalApprox{n} = sum(approx{n});
        y{n} = finalApprox{n};
    end
    setappdata(fig,'xaxis',x);
    plotType = plotTypeSelect.Value;
   if(strcmp(plotType,'Transmission'))
       y{n} = exp(-1.*y{n});
       ax.YLabel.String = 'Transmission';
   end
   
    switch numClicks
        case 1
        if(length(finalApprox) >1)
             out = sum(cell2mat(y'));
             setappdata(fig,'currentPlot1',out);
             plot(ax,x,out,'DisplayName',gasChoice);
        else
             setappdata(fig,'currentPlot1',y{1});
             plot(ax,x,y{1},'DisplayName',gasChoice);
        end
        
        case 2
        if(length(finalApprox) >1)
             out = sum(cell2mat(y'));
             setappdata(fig,'currentPlot2',out);
             plot(ax,x,out,'DisplayName',gasChoice);
        else
             setappdata(fig,'currentPlot2',y{1});
             plot(ax,x,y{1},'DisplayName',gasChoice);
        end
        
        case 3
        if(length(finalApprox) >1)
             out = sum(cell2mat(y'));
             setappdata(fig,'currentPlot3',out);
             plot(ax,x,out,'DisplayName',gasChoice);
        else
             setappdata(fig,'currentPlot3',y{1});
             plot(ax,x,y{1},'DisplayName',gasChoice);
        end
            
    end
     legend(ax);
end


##### SOURCE END #####
--></body></html>